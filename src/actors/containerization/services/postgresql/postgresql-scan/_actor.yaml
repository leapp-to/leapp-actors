inputs:
- name: aug_postgresql
  type:
    name: AugeasLensResult
- name: aug_pg_hba
  type:
    name: AugeasLensResult

outputs:
- name: postgresql_scanner
  type:
    name: TypePostgreSQLDetectionResult
    version: 1.0


description: |
  Scan PostgreSQL installation. Currently, the only supported input
  is from Augeas actor.

  Inputs:
    aug_postgresql - output of Augeas PostgreSQL lense
    aug_pg_hba - output of Augeas Pg_hba lense
  Outputs:
    postgresql_scanner - contains list of detected instances

execute:
    executable: /usr/bin/python
    script-file: scan.py
